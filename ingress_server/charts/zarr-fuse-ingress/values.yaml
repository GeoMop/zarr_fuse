global:
  # -- (int) Unique run identifier
  runId: 0

  s3:
    # -- (string) S3 endpoint URL
    endpointUrl: "endpointUrl"
    # -- (string) S3 store URL
    storeUrl: "storeUrl"
    # -- (object) S3 secrets
    # @default -- ~
    secrets:
      # -- (string) S3 access key
      accessKey: "accessKey"
      # -- (string) S3 secret key
      secretKey: "secretKey"

# -- (object) Ingress configuration
# @default -- ~
ingress:
  # -- (string) Ingress class name
  className: "nginx"
  # -- (dict) Ingress annotations
  annotations: {}
  # -- (dict) Ingress labels
  # @default -- {}
  labels: {}
  # -- (object) Hosts configuration
  # @default -- ~
  hosts:
  # - name: example.com
  #   tls:
  #     enabled: true
  #     secretName: example-com-tls

# -- (object) Ingress Service configuration
# @default -- ~
ingress-service:
  # -- (string) Application name
  name: ingress-service
  # -- (int) Number of desired pods
  replicaCount: 1
  # -- (string) Restart policy for the pod
  restartPolicy: Always
  # -- (string) Image pull policy
  imagePullPolicy: Always
  # -- (string) Part of label 'app.kubernetes.io/part-of'
  # @default -- .Chart.Name
  partOf: ""
  # -- (string) Component name for label 'app.kubernetes.io/component'
  # @default -- .Chart.Name
  component: "ingress-service"
  # -- (array) Extra environment variables injected into the application container.
  # -- Each item is an object with {name, value}.
  extraEnv: []
  # -- (dict) Extra labels to add to all resources
  extraLabels: {}
  # -- (dict) Extra annotations to add to all resources
  extraAnnotations: {}

  # -- (object) Image details
  # @default -- ~
  image:
    # -- (string) Hostname of the container registry
    host: docker.io
    # -- (string) Image repository
    name: jbrezmorf/zarr-fuse-ingress-service
    # -- (string) Image tag
    tag: ci-7aab59a

  # -- (object) Service configuration
  # @default -- ~
  configuration:
    # -- (object) FastAPI configuration
    # @default -- ~
    fastapi:
      # -- (object) FastAPI secrets
      # @default -- ~
      secrets:
        # -- (string/json) User/credentials definition for authentication.
        # -- Must be provided as a JSON string.
        # @default -- "{}"
        usersJson: "{}"

  # -- (object) Service configuration
  # @default -- ~
  service:
    # -- (string) Service type
    type: ClusterIP
    # -- (string) Service name
    name: ingress-service
    # -- (dict) Service labels
    labels: {}
    # -- (dict) Service annotations
    annotations: {}
    # -- (object) External port configuration
    # @default -- ~
    externalPort:
      # -- (int) Port number
      number: 80
      # -- (string) Port name
      name: http
    # -- (object) Internal port configuration
    # @default -- ~
    internalPort:
      # -- (int) Port number
      number: 8000
      # -- (string) Port name
      name: http

  # -- (object) Resource requests and limits
  # @default -- ~
  resources:
    # -- (object) Resource requests for the container
    # @default -- {}
    requests: {}
    #   cpu: 125m
    #   memory: 128Mi

    # -- (object) Resource limits for the container
    # @default -- {}
    limits: {}
    #   cpu: 250m
    #   memory: 256Mi

  # -- (object) Security context settings
  # @default -- ~
  securityContext:
    pod: {}
    container: {}

extractor-service:
  postgres:
    name: postgres
    replicaCount: 1
    restartPolicy: Always
    imagePullPolicy: IfNotPresent
    partOf: "extractor-service"
    component: "postgresql"
    extraLabels: {}
    extraAnnotations: {}
    extraEnv: []
    image:
      host: docker.io
      name: postgres
      tag: 16

    secrets:
      user: ""
      password: ""
      database: ""

    persistence:
      name: postgres-data
      storageClass: "csi-ceph-rbd-du"
      size: 10Gi
      volumeMode: Filesystem
      accessModes:
        - ReadWriteOnce

    # -- (object) Service configuration
    # @default -- ~
    service:
      # -- (string) Service type
      type: ClusterIP
      # -- (string) Service name
      name: postgres-service
      # -- (dict) Service labels
      labels: {}
      # -- (dict) Service annotations
      annotations: {}
      # -- (object) External port configuration
      # @default -- ~
      externalPort:
        # -- (int) Port number
        number: 5432
        # -- (string) Port name
        name: http
      # -- (object) Internal port configuration
      # @default -- ~
      internalPort:
        # -- (int) Port number
        number: 5432
        # -- (string) Port name
        name: http

    resources:
      requests:
        cpu: 100m
        memory: 100Mi
      limits:
        cpu: 500m
        memory: 500Mi

    securityContext:
      pod:
        runAsUser: 999
        runAsGroup: 999
        fsGroup: 999
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
      container:
        capabilities:
          drop:
            - ALL
        allowPrivilegeEscalation: false
        privileged: false
        runAsUser: 999
        runAsGroup: 999
        runAsNonRoot: true

  airflow:
    imagePullPolicy: IfNotPresent
    image:
      host: docker.io
      name: jbrezmorf/zarr-fuse-extractor-service
      tag: ci-7aab59a
    executor: LocalExecutor
    secrets:
      fernetKey: ""

    scheduler:
      name: airflow-scheduler
      replicaCount: 1
      restartPolicy: Always
      imagePullPolicy: IfNotPresent
      partOf: "extractor-service"
      component: "scheduler"
      extraLabels: {}
      extraAnnotations: {}
      extraEnv: []

      resources:
        requests:
          cpu: 100m
          memory: 256Mi
        limits:
          cpu: 500m
          memory: 1024Mi

      securityContext:
        pod:
          runAsUser: 50000
          runAsGroup: 50000
          fsGroup: 50000
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        container:
          capabilities:
            drop:
              - ALL
          allowPrivilegeEscalation: false
          privileged: false
          runAsUser: 50000
          runAsGroup: 50000
          runAsNonRoot: true

    webServer:
      name: airflow-webserver
      replicaCount: 1
      restartPolicy: Always
      imagePullPolicy: IfNotPresent
      partOf: "extractor-service"
      component: "scheduler"
      extraLabels: {}
      extraAnnotations: {}
      extraEnv: []
      secrets:
        webServerSecretKey: ""
      # -- (object) Service configuration
      # @default -- ~
      service:
        # -- (string) Service type
        type: ClusterIP
        # -- (string) Service name
        name: airflow-webserver-service
        # -- (dict) Service labels
        labels: {}
        # -- (dict) Service annotations
        annotations: {}
        # -- (object) External port configuration
        # @default -- ~
        externalPort:
          # -- (int) Port number
          number: 8080
          # -- (string) Port name
          name: http
        # -- (object) Internal port configuration
        # @default -- ~
        internalPort:
          # -- (int) Port number
          number: 80
          # -- (string) Port name
          name: http
      resources:
        requests:
          cpu: 100m
          memory: 256Mi
        limits:
          cpu: 500m
          memory: 1024Mi
      securityContext:
        pod:
          runAsUser: 50000
          runAsGroup: 50000
          fsGroup: 50000
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        container:
          capabilities:
            drop:
              - ALL
          allowPrivilegeEscalation: false
          privileged: false
          runAsUser: 50000
          runAsGroup: 50000
          runAsNonRoot: true

    initJob:
      name: airflow-init-job
      restartPolicy: OnFailure
      imagePullPolicy: IfNotPresent

      securityContext:
        pod:
          runAsUser: 50000
          runAsGroup: 50000
          fsGroup: 50000
          runAsNonRoot: true
          seccompProfile:
            type: RuntimeDefault
        container:
          capabilities:
            drop:
              - ALL
          allowPrivilegeEscalation: false
          privileged: false
          runAsUser: 50000
          runAsGroup: 50000
          runAsNonRoot: true
